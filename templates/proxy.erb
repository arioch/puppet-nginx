server {
  <% listen.each do |port| %>listen <%= port %>;
  <% end %>
  server_name <%= scope.lookupvar('server_name') -%>;

  location / {
    proxy_pass              <%= scope.lookupvar('proxy_pass') -%>;
    proxy_set_header        Host $host;
    proxy_set_header        X-Real-IP $remote_addr;
    proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_connect_timeout   <%= scope.lookupvar('proxy_connect_timeout') -%>;
    proxy_send_timeout      <%= scope.lookupvar('proxy_send_timeout') -%>;
    proxy_read_timeout      <%= scope.lookupvar('proxy_read_timeout') -%>;
    proxy_buffers           <%= scope.lookupvar('proxy_buffers') -%>;
    client_max_body_size    <%= scope.lookupvar('client_max_body_size') -%>;
    client_body_buffer_size <%= scope.lookupvar('client_body_buffer_size') -%>;
  <% if @proxy_ignore_headers %>
    <% proxy_ignore_headers.each do |ignore_header| %>proxy_ignore_headers    <%= ignore_header %>;
    <% end -%>
  <% end %>
  }
}

