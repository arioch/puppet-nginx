{"note":"Don't delete this file! It's used internally to help with page regeneration.","name":"Puppet-nginx","google":"","body":"# Puppet nGinX\r\n\r\n## Requirements\r\n\r\n* [concat module](https://github.com/ripienaar/puppet-concat)\r\n* Debian/Ubuntu: Puppetlabs [apt module](https://github.com/puppetlabs/puppetlabs-apt)\r\n\r\n## Tested on...\r\n\r\n* Debian 6 (Squeeze)\r\n\r\n## Example usage\r\n\r\n### HTTP reverse proxy\r\n\r\n    node /frontend/ {\r\n      class {\r\n        'nginx':;\r\n      }\r\n        \r\n      Nginx::Proxy {\r\n        ensure => present,\r\n        enable => true,\r\n      }\r\n    \r\n      nginx::proxy {\r\n        'test01.example.com': server_name => 'test01.example.com', proxy_pass => 'http://10.0.0.1';\r\n        'test02.example.com': server_name => 'test02.example.com', proxy_pass => 'http://10.0.0.2';\r\n      }\r\n    \r\n    }\r\n\r\n### HTTP reverse proxy, with load balancing\r\n\r\n    node /frontend/ {\r\n      class {\r\n        'nginx':;\r\n      }\r\n    \r\n      Nginx::Proxy {\r\n        ensure     => present,\r\n        enable     => true,\r\n        proxy_pass => 'http://backend',\r\n      }\r\n    \r\n      nginx::proxy {\r\n        'test01.example.com': server_name => 'test01.example.com';\r\n        'test02.example.com': server_name => 'test02.example.com';\r\n        'test03.example.com': server_name => 'test03.example.com';\r\n        'test04.example.com': server_name => 'test04.example.com';\r\n      }\r\n    \r\n      nginx::upstream { 'backend':\r\n        ip_hash        => true,\r\n        upstream_nodes => [\r\n          '10.0.1.1',\r\n          '10.0.1.2',\r\n          '10.0.1.3',\r\n          '10.0.1.4'\r\n        ];\r\n      }\r\n    }\r\n    \r\n### Load balancing with ip hashes (sticky connections)\r\n\r\nSticky connections are useful for applications that rely on cookies or\r\nbeing served by the same backend node for different reasons.\r\n\r\nThis is usually the case for PHP applications so it's enabled by default.\r\n\r\n    nginx::upstream { 'backend':\r\n      ip_hash        => true,\r\n      upstream_nodes => [\r\n        '10.0.1.1',\r\n        '10.0.1.2',\r\n        '10.0.1.3',\r\n        '10.0.1.4'\r\n      ];\r\n    }\r\n\r\n### Mail proxy\r\n\r\n    node /frontend/ {\r\n      class {\r\n        'nginx': mail => true;\r\n      }\r\n    \r\n      Nginx::Mail {\r\n        ensure         => present,\r\n        server_name    => $::fqdn,\r\n        listen_address => $::ipaddress,\r\n        proxy          => 'on'\r\n      }\r\n    \r\n      nginx::mail {\r\n        'imap':     listen_port => '143', protocol => 'imap';\r\n        'imaps':    listen_port => '993', protocol => 'imap';\r\n        'pop3':     listen_port => '110', protocol => 'pop3';\r\n        'pop3s':    listen_port => '995', protocol => 'pop3';\r\n        'smtp':     listen_port => '25',  protocol => 'smtp';\r\n        'smtp-465': listen_port => '465', protocol => 'smtp';\r\n        'smtp-587': listen_port => '587', protocol => 'smtp';\r\n      }\r\n    }\r\n\r\n","tagline":""}